import dependancies.Deps
import dependancies.Modules

apply plugin: 'com.android.application'
apply from: rootProject.file("android-commons.gradle")
apply from: rootProject.file("jacoco.gradle")

android {
    buildTypes {
        debug {
            resValue 'string', 'app_name', 'Skeleton Debug'
            applicationIdSuffix '.debug'
        }
        qa {
            shrinkResources true
            minifyEnabled true
            applicationIdSuffix '.qa'
            resValue 'string', 'app_name', 'Skeleton QA'
        }
        release {
            shrinkResources true
            minifyEnabled true
            resValue 'string', 'app_name', 'Skeleton'
        }
    }
}

task decodeKeystorePrebuildTask(type: Exec) {
    doFirst {
        workingDir "$projectDir"
        //Generate BASE64 encoded keystore with command "openssl base64 -A -in keystore.jks"
        //and save it to environment variable called "UPLOAD_KEYSTORE_ENCODED"
        String encodedKeystore = System.getenv("UPLOAD_KEYSTORE_ENCODED")
        String command = "echo $encodedKeystore | base64 --decode > keystore.jks"
        println(command)
        if (System.getProperty('os.name').toLowerCase(Locale.ROOT).contains('windows')) {
            commandLine 'cmd', '/c', "$command"
        } else {
            commandLine 'sh', '-c', "$command"
        }
    }
}

dependencies {
    api project(Modules.utils)
    api project(Modules.presentation)


    androidTestImplementation Deps.Testing.Helpers.kappuccino

    kaptAndroidTest Deps.AndroidX.dataBindingCompiler
}
